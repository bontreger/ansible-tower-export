---
- name: Import {{ ansible_automation_platform_awx_import_object | capitalize }} Debug Mode
  block:
  - name: Create Empty Error List
    set_fact:
      __ansible_automation_platform_awx_import_inventory_errors: []

  - name: Read Assets form Export
    set_fact:
      __ansible_automation_platform_awx_import_inventory_asset: "{{ lookup('file', '{{ __ansible_automation_platform_awx_import_assets_path }}/inventory.json') |regex_replace('{{','__ANSIBLE_VARIABLE_BRACKETS_OPEN__') }}"

  - name: Read Assets form Export
    set_fact:
      __ansible_automation_platform_awx_import_inventory_asset: !unsafe "{{ __ansible_automation_platform_awx_import_inventory_asset |regex_replace('{{','@@') }}"
    when: false

  - name: Import {{ ansible_automation_platform_awx_import_object | capitalize }} Asset Tasks
    include_tasks: import_asset.yml
    loop: "{{ __ansible_automation_platform_awx_import_inventory_asset.inventory }}"
    loop_control:
      loop_var: __ansible_automation_platform_awx_import_object_asset
 
  when: ansible_automation_platform_awx_import_debug is defined

- name: Import {{ ansible_automation_platform_awx_import_object | capitalize }} Asset
  ansible.controller.import:
    assets:                         "{{ lookup('file', '{{ __ansible_automation_platform_awx_import_assets_path }}/inventory.json') }}"
    controller_username:            "{{ controller_username }}"
    controller_password:            "{{ controller_password }}"
    controller_host:                "{{ inventory_hostname }}"
    validate_certs: false
  when: ansible_automation_platform_awx_import_debug is not defined
...
